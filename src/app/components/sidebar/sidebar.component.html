<!-- Single canonical content template, reused in different wrappers -->
<ng-template #sidebarContent>
    <div class="sidebar-inner">
        <div class="brand">
            <div class="logo">MM</div>
        </div>

        <nav class="nav">
            <p>{{ viewportCategory() }}</p>
            <a class="nav-item" href="#">Home</a>
            <a class="nav-item" href="#">Games</a>
            <a class="nav-item" href="#">Servers</a>
            <a class="nav-item" href="#">Settings</a>
        </nav>

        <div class="spacer"></div>

        <div class="footer">
            @if (viewportCategory() !== 'phone') {
                <button class="collapse-btn" (click)="onToggleButtonClick()" aria-label="Toggle sidebar">
                    <span *ngIf="layout.isMenuOpen()">Collapse</span>
                    <span *ngIf="!layout.isMenuOpen()">Expand</span>
                </button>
            }
        </div>
    </div>
</ng-template>


<!-- overlay backdrop -->
@if ((viewportCategory() !== 'desktop')) {
    <div class="backdrop"
        (pointerdown)="onBackdropPointerDown()" [style.opacity]="backdropOpacity()"
        [class.visible]="(layout.isMenuOpen() || layout.isMenuDragging() || layout.menuOpenRatio() > 0)">
    </div>
}
<!-- PHONE: off-canvas overlay (draggable) -->
@if (viewportCategory() === 'phone') {
    <!-- edge area to start drag (10% width) -->
    <div class="touch-edge" (pointerdown)="onPhoneEdgePointerDown($event)" [attr.aria-hidden]="true"></div>
    <!-- off-canvas container -->
    <div class="phone-drawer" role="navigation" [style.width.px]="phoneWidthPx()" [style.transform]="phoneTransform()"
        [class.open]="drawerOpenState()" [class.dragging]="layout.isMenuDragging()">
        <ng-container [ngTemplateOutlet]="sidebarContent"></ng-container>
    </div>

}

<!-- TABLET: docked collapsed + optional overlay expansion -->
@if (viewportCategory() === 'tablet') {
    <aside class="docked docked-collapsed" role="navigation" [style.width.px]="150">
        <ng-container [ngTemplateOutlet]="sidebarContent"></ng-container>
    </aside>

    <!-- tablet overlay when expanded -->
    @if (layout.isMenuOpen()) {
        <div class="tablet-overlay-panel" (pointerdown)="$event.stopPropagation()"
            [style.width.px]="tabletOverlayWidthPx()">
            <ng-container [ngTemplateOutlet]="sidebarContent"></ng-container>
        </div>
    }
}

<!-- DESKTOP: docked (pushes content). Single dock element that changes width -->
@if (viewportCategory() === 'desktop') {
    <aside class="docked" role="navigation" [style.width.px]="desktopDockWidth()">
        <ng-container [ngTemplateOutlet]="sidebarContent"></ng-container>
    </aside>
}