<div class="vessel-card-2">
    <!-- Header with unit name -->
    <div class="vessel-header">
        @let alias = forceUnit()?.alias();
        @if (alias) {
            @let longChassis = alias.length > 30;
            <span class="alphastrike-text vessel-name" [class.stroked]="cardStyle() != 'monochrome'" [class.long-chassis]="longChassis">{{ alias }}</span>
            <span class="vessel-name-subtext">{{ unit().chassis | uppercase }} {{ unit().model | uppercase }}</span>
        } @else {
            @let longChassis = chassis().length > 30;
            <span class="alphastrike-text vessel-name" [class.stroked]="cardStyle() != 'monochrome'" [class.long-chassis]="longChassis">{{ unit().chassis | uppercase }}</span>
            <span class="vessel-model">{{ unit().model | uppercase }}</span>
        }
    </div>

    <!-- Arc Damage Tables Grid -->
    <div class="arc-damage-grid">
        @for (arc of effectiveArcDamageData(); track arc.label) {
        <div class="arc-damage-table frame">
            <div class="frame-background"></div>
            <div class="frame-content">
                <!-- Arc Label (vertical) -->
                <div class="arc-label-container">
                    <span class="arc-label">{{ arc.label }}</span>
                </div>

                <!-- Damage Table -->
                <div class="damage-table" [class.has-cap]="hasCap()">
                    <!-- Header Row -->
                    <div class="table-header">
                        <div class="range-col"></div>
                        <div class="dmg-col">STD</div>
                        @if (hasCap()) {<div class="dmg-col">CAP</div>}
                        <div class="dmg-col">SCAP</div>
                        <div class="dmg-col">MSL</div>
                    </div>

                    <!-- S Row -->
                    <div class="table-row">
                        <div class="range-col">S ({{ toHitShort() }}+)</div>
                        <div class="dmg-col">{{ arc.effDmgS }}</div>
                        @if (hasCap()) {<div class="dmg-col">{{ arc.effCapS }}</div>}
                        <div class="dmg-col">{{ arc.effScapS }}</div>
                        <div class="dmg-col">{{ arc.effMslS }}</div>
                    </div>

                    <!-- M Row -->
                    <div class="table-row">
                        <div class="range-col">M({{ toHitMedium() }}+)</div>
                        <div class="dmg-col">{{ arc.effDmgM }}</div>
                        @if (hasCap()) {<div class="dmg-col">{{ arc.effCapM }}</div>}
                        <div class="dmg-col">{{ arc.effScapM }}</div>
                        <div class="dmg-col">{{ arc.effMslM }}</div>
                    </div>

                    <!-- L Row -->
                    <div class="table-row">
                        <div class="range-col">L ({{ toHitLong() }}+)</div>
                        <div class="dmg-col">{{ arc.effDmgL }}</div>
                        @if (hasCap()) {<div class="dmg-col">{{ arc.effCapL }}</div>}
                        <div class="dmg-col">{{ arc.effScapL }}</div>
                        <div class="dmg-col">{{ arc.effMslL }}</div>
                    </div>

                    <!-- E Row -->
                    <div class="table-row">
                        <div class="range-col">E ({{ toHitExtreme() }}+)</div>
                        <div class="dmg-col">{{ arc.effDmgE }}</div>
                        @if (hasCap()) {<div class="dmg-col">{{ arc.effCapE }}</div>}
                        <div class="dmg-col">{{ arc.effScapE }}</div>
                        <div class="dmg-col">{{ arc.effMslE }}</div>
                    </div>

                    @let columns = hasCap() ? 4 : 3;
                    <!-- SPE Row -->
                    <div class="table-row spe-row">
                        <div class="range-col">SPE</div>
                        <div class="dmg-col spe-value" [attr.colspan]="columns">{{ arc.spe ?? '' }}</div>
                    </div>

                    <!-- CRIT Row -->
                    <div class="table-row crit-row">
                        <div class="range-col">CRIT</div>
                        <div class="crit-pips-container">
                            @for (col of range(columns); track col) {
                            @let critKey = arc.shortLabel + '-' + getColumnName(col);
                            <div class="crit-pip-group" [attr.data-crit]="critKey">
                                @for (i of range(4); track i) {
                                    <svg class="pip" 
                                         [class.damaged]="isCritPipDamaged(critKey, i)"
                                         [class.pending-damage]="isCritPipPendingDamage(critKey, i)"
                                         [class.pending-heal]="isCritPipPendingHeal(critKey, i)"
                                         viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" /></svg>
                                }
                            </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
        }
    </div>

    <!-- Weapon Criticals Note -->
    <div class="weapon-criticals-note">
        <span class="note-title">WEAPON CRITICALS</span>
        <span class="note-text">Damage Value Reduced by 25% per hit. â€” Randomly determine an appropriate STD/@if(hasCap()){CAP/}SCAP/MSL column.</span>
    </div>
</div>

<!-- Destroyed Overlay -->
@if (isDestroyed()) {
<div class="destroyed-overlay">
</div>
}
