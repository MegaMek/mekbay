@if (dirtyPhase()) {
<div class="phase-controls">
    <button role="button" class="phase-button end-phase-button preventZoomReset" tabindex="0"
        (click)="endPhase($event)">
        COMMIT AND END PHASE
    </button>
</div>
}

<div class="container">
    <button role="button" class="overlay-button turn-tracker-button preventZoomReset" tabindex="0"
        (click)="openTurnSummary($event)">
        @let phase = currentPhase();
        @if (falling()) {
        <svg width="40px" height="40px" version="1.1" viewBox="0 0 16 14" xmlns="http://www.w3.org/2000/svg">
            <path
                d="m15.8 12.2-6.97-11.758a1 1 0 0 0-1.66 0l-7.007 11.858c-0.38 0.6-0.07 1.7 0.68 1.7h14.357c0.7 0 1-1.1 0.6-1.8z"
                fill="#f00" />
            <path
                d="m 10.8,11 c -0.6,-0.1 -1.11,0.1 -1.28,0.6 -0.16,0.4 0,1 0.47,1.2 0.61,0.1 1.11,0 1.31,-0.6 0.2,-0.5 0,-1 -0.5,-1.2 z M 3.61,8.15 5.82,9.38 6.02,9.44 6.31,9.38 7.96,8.56 8.12,10.8 c -0.69,0.5 -2.2,1.1 -2.41,1.3 -0.19,0.1 -0.26,0.4 -0.17,0.5 0.1,0.2 0.49,0.2 0.68,0.1 l 3.29,-1.6 c 0.1,0 0.17,-0.1 0.25,-0.2 l 1.54,-1.68 1.8,0.32 c 0.1,0 0.4,-0.1 0.4,-0.32 0,-0.25 -0.1,-0.44 -0.4,-0.5 L 11.3,8.35 c -0.2,0 -0.4,0.1 -0.5,0.22 L 9.99,9.3 9.77,7.24 C 9.77,7 9.52,6.67 9.36,6.58 L 7.71,5.93 7.63,4.05 C 7.63,3.85 7.39,3.55 7,3.54 6.62,3.53 6.39,3.92 6.39,4.17 l 0.17,2.25 c 0,0.16 0.16,0.33 0.33,0.41 L 7.88,7.24 6.15,8.15 4.18,7.08 C 3.79,6.94 3.51,7.05 3.36,7.34 3.2,7.62 3.36,7.98 3.61,8.15 Z"
                fill="#ffffff" />
        </svg>
        } @else if (hasPSRChecks()) {
        <svg class="warning" fill="currentColor" width="40px" height="40px" viewBox="0 0 16 16"
            xmlns="http://www.w3.org/2000/svg">
            <path
                d="M15.83 13.23l-7-11.76a1 1 0 0 0-1.66 0L.16 13.3c-.38.64-.07 1.7.68 1.7H15.2C15.94 15 16.21 13.87 15.83 13.23Z" />
            <text x="50%" y="55%" text-anchor="middle" dominant-baseline="mathematical" font-size="8">
                {{ psrCount() }}!
            </text>
        </svg>
        } @else {
        <svg [class.dirty]="dirty()" [class.ranged]="phase === 'W'" [class.physical]="phase === 'P'"
            [class.heat]="phase === 'H'" fill="currentColor" width="40px" height="40px" viewBox="0 0 32 32"
            xmlns="http://www.w3.org/2000/svg">
            <path class="octagon"
                d="M30.8508,15.4487,23.8867,3.5322A1.0687,1.0687,0,0,0,22.9643,3H9.0357a1.0687,1.0687,0,0,0-.9224.5322L1.1492,15.4487a1.0933,1.0933,0,0,0,0,1.1026L8.1133,28.4678A1.0687,1.0687,0,0,0,9.0357,29H22.9643a1.0687,1.0687,0,0,0,.9224-.5322l6.9641-11.9165A1.0933,1.0933,0,0,0,30.8508,15.4487Z" />
            <text x="50%" y="55%" text-anchor="middle" dominant-baseline="middle" font-size="16">
                {{ currentPhase() }}
            </text>
        </svg>
        }
    </button>
</div>